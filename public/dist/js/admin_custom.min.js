"use strict";function enableDisableButton(){hasPhoneError||hasEmailError?$("form").find("button[type='submit']").prop("disabled",!0):$("form").find("button[type='submit']").prop("disabled",!1)}function formattedPhone(){var e;""!=$("#phone").val&&(e=$("#phone").intlTelInput("getNumber").replace(/-|\s/g,""),$("#formattedPhone").val(e))}function enableDisableButton(){hasPhoneError||hasEmailError?$("form").find("button[type='submit']").prop("disabled",!0):$("form").find("button[type='submit']").prop("disabled",!1)}function formattedPhone(){var e;""!=$("#phone").val&&(e=$("#phone").intlTelInput("getNumber").replace(/-|\s/g,""),$("#formattedPhone").val(e))}function checkInvalidAndDuplicatePhoneNumberForUserProfile(e,t,r){var a=$("input[name=phone]");""!==$.trim(a.val())?a.intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim(a.val()))?($("#tel-error").html(""),$("#id").val(),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ADMIN_URL+"/duplicate-phone-number-check",dataType:"json",cache:!1,data:{phone:e,carrierCode:t,id:r}}).done(function(e){1==e.status?($("#tel-error").html(""),$("#phone-error").show(),$("#phone-error").addClass("error").html(e.fail).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton()):0==e.status&&($("#tel-error").show(),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})):($("#tel-error").addClass("error").html(validPhoneNumberErrorText).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())}var countryData;$(".content-wrapper").find("#discussion-reply").length&&($("#reply").validate({rules:{description:{required:!0},file:{extension:extensionsValidationRule}},messages:{file:{extension:extensionsValidationMessage}},submitHandler:function(e){$("#dispute-reply").attr("disabled",!0).click(function(e){e.preventDefault()}),$(".fa-spin").show(),$("#dispute-reply-text").text(submittingText),e.submit()}}),$("#status").on("change",function(){var r=$(this).val(),e=$("#id").val();$.ajax({method:"POST",url:ADMIN_URL+"/dispute/change_reply_status",data:{status:r,id:e}}).done(function(e){message="Dispute discussion "+r+" successfully done.",message=statusChangeText.replace(":x",r);var t='<div class="alert alert-success" role="alert">'+message+"</div><br>";$("#alertDiv").html(t),location.reload().delay(1e4)})})),$(".content-wrapper").find("#ticket-reply").length&&($(function(){$(".select2").select2({})}),$(function(){$(".message").wysihtml5({events:{change:function(){0===$(".message").val().length?$("#error-message").addClass("error").html("This field is required.").css("font-weight","bold"):$("#error-message").html("")}}})}),$(function(){$(".editor").wysihtml5({events:{change:function(){0===$(".editor").val().length?$("#error-message-modal").addClass("error").html("This field is required.").css("font-weight","bold"):$("#error-message-modal").html("")}}})}),$.validator.setDefaults({highlight:function(e){$(e).parent("div").addClass("has-error")},unhighlight:function(e){$(e).parent("div").removeClass("has-error")},errorPlacement:function(e,t){"message"===t.prop("name")?$("#error-message").html(e):"editor"===t.prop("id")?$("#error-message-modal").html(e):e.insertAfter(t)}}),$("#reply_form").validate({ignore:":hidden:not(textarea)",rules:{message:"required",file:{extension:extensions}},messages:{file:{extension:fileErrorMessage}},submitHandler:function(e){$("#reply").attr("disabled",!0),$(".fa-spin").show(),$("#reply_text").text("Replying..."),$("#customer_reply_button").attr("disabled",!0),$("#admin_reply_button").attr("disabled",!0),$(".edit-btn").attr("disabled",!0),$("#customer_reply_button").click(!1),$("#admin_reply_button").click(!1),$(".edit-btn").click(!1),e.submit()}}),$("#replyModal").validate({rules:{message:{required:!0}}}),$(document).ready(function(e){$(".edit-btn").on("click",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-message");t&&$("#replyModal iframe").contents().find(".wysihtml5-editor").html(t),$("#reply_id").val(e)})}),$(document).on("input","#status_ticket",function(){var e=$("#status_ticket").val();$.ajax({url:ticketStatusChangeUrl,method:"POST",data:{status_id:e,ticket_id:ticket_id,_token:token},dataType:"json",success:function(e){"1"==e.status&&$("#status_label").html(e.message)}})})),$(".content-wrapper").find("#user-create").length&&($(function(){$(".select2").select2({})}),$.validator.setDefaults({highlight:function(e){$(e).parent("div").addClass("has-error")},unhighlight:function(e){$(e).parent("div").removeClass("has-error")},errorPlacement:function(e,t){e.insertAfter(t)}}),$("#user_form").validate({rules:{first_name:{required:!0,alpha:!0,maxlength:30},last_name:{required:!0,alpha:!0,maxlength:30},email:{required:!0,email:!0},password:{required:!0,minlength:6},password_confirmation:{required:!0,minlength:6,equalTo:"#password"}},messages:{password_confirmation:{equalTo:passwordMatchErrorText},first_name:{alpha:userNameError,maxlength:userNameLengthError},last_name:{alpha:userNameError,maxlength:userNameLengthError}},submitHandler:function(e){$("#users_create").attr("disabled",!0),$(".fa-spin").show(),$("#users_create_text").text(creatingText),$("#users_cancel").attr("disabled",!0),e.submit()}}),$.validator.addMethod("alpha",function(e,t){return this.optional(t)||e==e.match(/^[a-zA-Z\s]+$/)}),$(document).ready(function(){$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:[countryShortCode],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",utilsScript:utilsScriptLoadingPath});var e=$("#phone").intlTelInput("getSelectedCountryData");$("#defaultCountry").val(e.iso2),$("#carrierCode").val(e.dialCode),$("#phone").on("countrychange",function(e,t){formattedPhone(),$("#defaultCountry").val(t.iso2),$("#carrierCode").val(t.dialCode),""!==$.trim($(this).val())?$(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))?($("#tel-error").html(""),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ADMIN_URL+"/duplicate-phone-number-check",dataType:"json",cache:!1,data:{phone:$.trim($(this).val()),carrierCode:$.trim(t.dialCode)}}).done(function(e){1==e.status?($("#tel-error").html(""),$("#phone-error").show(),$("#phone-error").addClass("error").html(e.fail).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton()):0==e.status&&($("#tel-error").show(),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})):($("#tel-error").addClass("error").html(validPhoneNumberErrorText).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})}),$(document).ready(function(){$("input[name=phone]").on("blur",function(e){var t,r;formattedPhone(),""!==$.trim($(this).val())?$(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))?(t=$(this).val().replace(/-|\s/g,""),t=$(this).val().replace(/^0+/,""),r=$("#phone").intlTelInput("getSelectedCountryData").dialCode,$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ADMIN_URL+"/duplicate-phone-number-check",dataType:"json",data:{phone:t,carrierCode:r}}).done(function(e){1==e.status?0==t.length?$("#phone-error").html(""):($("#phone-error").addClass("error").html(e.fail).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton()):0==e.status&&($("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())}),$("#tel-error").html(""),$("#phone-error").show(),hasPhoneError=!1,enableDisableButton()):($("#tel-error").addClass("error").html(validPhoneNumberErrorText).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})}),$(document).ready(function(){$("#email").on("blur",function(e){var a=$("#email").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ADMIN_URL+"/email_check",dataType:"json",data:{email:a}}).done(function(e){function t(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function r(){0===a.length&&($("#email_error").html(""),$("#email_ok").html(""))}1==e.status?(r(),t(a)?($("#email_error").addClass("error").html(e.fail).css("font-weight","bold"),$("#email_ok").html(""),hasEmailError=!0,enableDisableButton()):$("#email_error").html("")):0==e.status&&(r(),(t(a)?$("#email_error"):$("#email_ok")).html(""),hasEmailError=!1,enableDisableButton())})})})),$(".content-wrapper").find("#user-edit").length&&($(function(){$(".select2").select2({}),$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:["us"],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",formatOnDisplay:!1,utilsScript:utilsScriptLoadingPath}).done(function(){null!==formattedPhoneNumber&&null!==carrierCode&&null!==defaultCountry&&($("#phone").intlTelInput("setNumber",formattedPhoneNumber),$("#user_defaultCountry").val(defaultCountry),$("#user_carrierCode").val(carrierCode))})}),countryData=$("#phone").intlTelInput("getSelectedCountryData"),$("#user_defaultCountry").val(countryData.iso2),$("#user_carrierCode").val(countryData.dialCode),$("#phone").on("countrychange",function(e,t){$("#user_defaultCountry").val(t.iso2),$("#user_carrierCode").val(t.dialCode),formattedPhone();var r=$("#id").val();checkInvalidAndDuplicatePhoneNumberForUserProfile($.trim($(this).val()),$.trim(t.dialCode),r)}),$("#phone").on("blur",function(e){formattedPhone();var t=$("#id").val();$(this).val().replace(/-|\s/g,"");checkInvalidAndDuplicatePhoneNumberForUserProfile($(this).val().replace(/^0+/,""),$(this).intlTelInput("getSelectedCountryData").dialCode,t)}),$(document).ready(function(){$("#email").on("input",function(e){var r=$(this).val(),t=$("#id").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ADMIN_URL+"/email_check",dataType:"json",data:{email:r,user_id:t}}).done(function(e){function t(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}0===r.length&&($("#emailError").html(""),$("#email-ok").html("")),1==e.status?t(r)?($("#emailError").addClass("error").html(e.fail).css("font-weight","bold"),$("#email-ok").html(""),hasEmailError=!0,enableDisableButton()):$("#emailError").html(""):0==e.status&&(hasEmailError=!1,enableDisableButton(),(t(r)?$("#emailError"):$("#email-ok")).html(""))})})}),$(document).on("change","#status",function(){var e=$("#status").val();"Inactive"==e?$("#user-status").text(inactiveWarning):"Suspended"==e?$("#user-status").text(suspendWarning):$("#user-status").text("")}),$("#user_form").validate({rules:{first_name:{required:!0,alpha:!0,maxlength:30},last_name:{required:!0,alpha:!0,maxlength:30},email:{required:!0,email:!0},password:{minlength:6},password_confirmation:{minlength:6,equalTo:"#password"}},messages:{password_confirmation:{equalTo:passwordMatchErrorText},first_name:{alpha:userNameError,maxlength:userNameLengthError},last_name:{alpha:userNameError,maxlength:userNameLengthError}},submitHandler:function(e){$("#users_edit").attr("disabled",!0),$(".fa-spin").show(),$("#users_edit_text").text(updatingText),$("#users_cancel").attr("disabled","disabled"),e.submit()}}),$.validator.addMethod("alpha",function(e,t){return this.optional(t)||e==e.match(/^[a-zA-Z\s]+$/)}));